<a name="top" />

**Last SDK Version: 2.4.0**

This document describes the basic procedure for integrating StartApp In-App Ads into your Cocos2d-x applications for iOS. <br></br>
After this simple integration process, StartApp In-App Ads enables you to reap the benefits of StartApp's In-App monetization products, which maximize the revenue generated by your application. All this profit-making is achieved with minimal effort and minimal interference with your users’ experience.

<img src="./cocos2dx_iOS/images/ios-cube.png" width="600px" />


> **NOTES:**
> - The code samples in this document can be copy/pasted into your source code
> - When submitting your application to the App Store,do not forget to update your ["IDFA Settings"](#IDFA) 
> - If you have any questions, contact us via [support@startapp.com](mailto:support@startapp.com)

<br></br>
<a name="step1" />
##Step 1, Adding the StartApp SDK and StartApp Cocos2d-x plugin to your project
In order to add StartApp SDK to your application please follow the following steps:

**1.** Unzip the SDK files to a temporary folder  
**2.** Drag and drop _StartApp framework_, _StartApp bundle_, _StartApp_Cocos2DX_x_x_x.a_ and _StartAppPlugin.h_ to your project  

[Back to top](#top)

<a name="step2" />
##Step 2, Adding frameworks
####Add frameworks to your application project directory
1.	Select your application project to bring up the project editor
2.	Select your application target to bring up the target editor
3.	Select the Build Phases tab and disclose the "Link Binary with Libraries" phase and click the plus button in that phase
4.	Add the following frameworks:
<br></br><img src="./iOS/images/V.png" width="12px" /> _CoreTelephony.framework_ 
<br></br><img src="./iOS/images/V.png" width="12px" /> _SystemConfiguration.framework_ 
<br></br><img src="./iOS/images/V.png" width="12px" /> _CoreGraphics.framework_ 
<br></br><img src="./iOS/images/V.png" width="12px" /> _StoreKit.framework_ 
<br></br><img src="./iOS/images/V.png" width="12px" /> _AdSupport.framework_ 
<br></br><img src="./iOS/images/V.png" width="12px" /> _QuartzCore.framework_ 
<br></br><br></br>[[/iOS/images/frameworks.png]]

[Back to top](#top)


<a name="step3" />
##Step 3, Initialization
In your application delegate class (_AppDelegate.cpp_), include the StartApp SDK and add the following lines to your application's ``didFinishLaunchingWithOptions`` function:

```cpp
// AppDelegate.cpp

#include "StartAppPlugin.h"
bool AppDelegate::applicationDidFinishLaunching() 
{
    startappiOS* startAppBridge = startappiOS().sharedInstance();
    startAppBridge->STAInit("your app Id", "your developer id");
    return true;
}
```

Replace __"Your Account Id"__ and  __"Your App ID"__ with your own values provided in the [developers’ portal](http://developers.startapp.com).<br></br>
After logging in, your account ID will be displayed at the top right-hand corner of the page:
<img src="./Android/images/accountId.png" />

To find your application ID, click on the "Apps and Sites" tab on the left pane and choose the relevant ID from your app list:<br></br>
<img src="./iOS/images/ios-appId.png" />

[Back to top](#top)


<a name="splash-ads" />
##Showing the Splash Ad
A Splash Ad is a full-page ad that is displayed immediately after the application is launched.
A Splash Ad first displays a full page splash screen that you define (as described below) followed by a full page ad.   

StartApp SDK provides two modes for displaying Splash screens:

**Splash Screen Mode**     |     **Description**
-------------------------- | -------------------
User-Defined Mode (default)    | Using your application's default splash image, with a loading animation
Template Mode                  | StartApp SDK provides a pre-defined template in which you can place your own creatives, such as application name, logo and loading animation. for more details, please refer to the ["Advanced Manual"](cocos2dx-ios-advanced-usage#CustomizingSplashScreen)

####Adding the Splash Screen 
In your application delegate class (_AppDelegate.cpp_), after initializing the SDK, call the ``showSplashAd`` method:
```cpp
// AppDelegate.cpp

#include "StartAppPlugin.h"

bool AppDelegate::applicationDidFinishLaunching() 
{
    startappiOS* startAppBridge = startappiOS().sharedInstance();
    startAppBridge->showSplashAd();
    return true;
}
```

**If you wish to customize or use a different splash screen, please refer to the [Advanced Usage](cocos2dx-ios-advanced-usage#CustomizingSplashScreen).**

[Back to top](#top)


<a name="step4" />
##Showing Interstitial Ads
######You can choose to show the interstitial ad in several locations within your application. This could be between stages, while waiting for an action, when pressing a button and more.

First, import the StartApp SDK in your view controller and add the following lines to the cpp file for each view in which you would like to show an ad
```cpp
// HelloWorldScene.cpp

#include "StartAppPlugin.h"

bool HelloWorld::init()
{
    startappiOS* startAppBridge =  startappiOS().sharedInstance();
    startAppBridge->loadAd();    
    return true;
}
```

Then, just add the following line where you want to show the ad
```cpp
startAppBridge->showAd();   
```

> **IMPORTANT**  
>Loading an ad might take a few seconds so it's important to show the ad as late as you can. In case you call ``showAd()`` while the ad hasn't been successfully loaded yet, nothing will be displayed.  For example, if you'd like to show an ad after completing a game's level, the best practice would be to show the ad upon completing the level (for example in your ``viewDidDisappear()`` function). On the other hand, loading and showing the ad together at the beginning of the next level might result with a failure – as the ad might not have enough time to load.

[Back to top](#top)


<a name="return-ads" />
##Return Ads
The **Return Ad** is a new ad unit which is displayed once the user returns to your application after a certain period of time.  To minimize the intrusiveness, short time periods are ignored. For example, the Return Ad won't be displayed if the user leaves your application to take a short phone call before returning. 

Return ads are enabled and activated by default. If you want to disable this feature, simply call ``startAppBridge->disableReturnAd()`` as part of the initialization process, in your _AppDelegate.cpp_ file:
 ```cpp
// AppDelegate.cpp

#include "StartAppPlugin.h"

bool AppDelegate::applicationDidFinishLaunching()
{
    startAppBridge->disableReturnAd(); 
    return true;
}
```

[Back to top](#top)


<a name="step5" />
##Showing Banners
First, include _StartAppPlugin.h_ in the header file of your view controller
```cpp
#include "StartAppPlugin.h"
```

Then, call ``loadBanner`` in the view controller where you want the banner to be displayed.
```cpp
startAppBridge->loadBanner(startappiOS::STAAdOrigin_Bottom, 
						   startappiOS::STA_AutoAdSize);
```

<a name="PositioningTheBanner" />
####Positioning the banner
The origin of the banner is determined by the first parameter which can receive one of the following values

Value | Position | Behaviour
--- | --- | ---
`STAAdOrigin_Top` | Auto Top | The banner will be centered and pinned to the top of the view. In case the view is a root view controller, the banner will be located under the status bar, if exists.
`STAAdOrigin_Bottom` | Auto Bottom | The banner will be centered and pinned to the bottom of the view.

> **NOTE** <br></br>
> If you wish to use a fixed origin for the banner, please refer to the ["Advanced Manual"](cocos2dx-ios-advanced-usage#UsingFixedOriginBanner)

[Back to top](#top)


<a name="Demographic" />
##Enjoy Higher eCPM with Demographic-Targeted Ads
If you know your user's gender, age or location, StartApp can use it to serve better-targeted ads which can increase your eCPM and revenue significantly.

####Set Age and Gender
Upon initialization, after providing your DevId and AppId, add the age and gender:
```cpp
startAppBridge->STAInit("your app Id", "your developer id", "user age", "user gender");
```

+ Replace "user age" with the user's real age 
+ Replace "user gender" with the user's real gender, using *STAGender_Male* or *STAGender_Female*.


**Example** - for a 22 years male use:
```cpp
// AppDelegate.cpp

#include "StartAppPlugin.h"
bool AppDelegate::applicationDidFinishLaunching() 
{
    startappiOS* startAppBridge = startappiOS().sharedInstance();
    startAppBridge->STAInit("1234", "5678", 22, startappiOS::STAGender_Male);
    return true;
}
```

(replace "1234" and "5678" with your REAL developer Id and App Id)

####Set Location
The location of the user is a dynamic property which is changed constantly. Hence, you should provide it every time you load a new Ad, uasing the _STAAdPreferences_ object:

```cpp
startappiOS::STAAdPreferences *pref = new startappiOS::STAAdPreferences();
pref->userLocation.longitude = 32.44444;
pref->userLocation.latitude = 30.2222;

startAppBridge->loadAd(pref, STACallbacks);
```

[Back to top](#top)

<a name="IDFA" />
##Updating your IDFA Settings
When submitting your application to the App Store you need to update its "Advertising Identifier (IDFA)" settings in order to comply with Apple advertising policy.

On the "Advertising Identifier" section: <br></br>
**1** Choose "Yes" on the right pane <br></br>
**2** Opt-in the "Serve advertisements within the app" checkbox <br></br>
**3** Opt-in the confirmation checkbox under "Limit Ad tracking setting in iOS"  <br></br>

[[/iOS/images/idfa.jpg]]

[Back to top](#top)

<a name="AdvancedUsage" />
##Advanced Usage
For advanced usage, please read our ["Advanced Manual"](cocos2dx-ios-advanced-usage)

[Back to top](#top)
